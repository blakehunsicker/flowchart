<!DOCTYPE html>
  <head>
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  	<link rel="stylesheet" type="text/css" href="stream.css">
  	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<style>
		
		
	</style>
  </head>
  <body>
  	<div class="row">
  	<div class="col-md-12" style="height:20px;color:#fff;background:#111;position:fixed;z-index:100000;margin-bottom:10px;">Flowchart concept test</div>
  	</div>
  	<div class="container" style="margin-top:50px;">
	  	<div class="col-sm-5" style="height:1300px;">
	  		<div class="editor" style="margin-top:80px;position:fixed;">
		  		<h3><span class="fill"></span></h3>
		  		<div class="input-group" style="width:400px;">
				  <input type="text" class="form-control question-field" placeholder="Enter question text here" aria-describedby="basic-addon2">
				</div>
				<div class="add-button">Add media</div>
		  		<h5>Answer A</h5>
		  		<div class="input-group" style="width:400px;">
				  <input type="text" class="form-control answer-a-field" placeholder="Yes" aria-describedby="basic-addon2">
				</div>
		  		<h5>Answer B</h5>
		  		<div class="input-group" style="width:400px;">
				  <input type="text" class="form-control answer-b-field" placeholder="No" aria-describedby="basic-addon2">
				</div>
		  		<div class="add-button">Add answer</div>
		  		<div class="save">Save</div>
	  		</div>
	  	</div>
	  	<div class="stream col-sm-6" style="height:2000px;">
	  		<span class="horizontal-line hl1"></span>
	  		<span class="horizontal-line hl2"></span>
	  		<span class="horizontal-line hl3" style="display:none;"></span>
	  		<span class="horizontal-line hl4" style="display:none;"></span>
	  		<span class="vertical-line v1"></span>
	  		<span class="vertical-line v2"></span>
	  		<span class="vertical-line v3" style="display:none;"></span>
	  		<span class="vertical-line v4" style="display:none;"></span>
			  <div class="question Q1 item col-sm-10">
				  <div class="row">
				  	<div class="col-xs-10">
						  <h6 class="question-number q-number">Question 1</h6>
						  <h5 class="question-text">Do you have a child?</h5>
						  <div class="answer-wrap">
								<div class="answer-tag">Answer A</div>
						  	<span class="answer">Yes</span> <span class="transit_text">goes to</span> <span class="destination_tag">Q2</span>
						  </div>
						  <div class="answer-wrap">
								<div class="answer-tag">Answer B</div>
						  	<span class="answer">No </span> <span class="transit_text">goes to</span> <span class="destination_tag">Q4</span>
						  	<span class="answer-tag active" style="
								    position: absolute;
								    right: -104px;
								">Answer A</span>
						  </div>
					  </div>
					  <div class="col-xs-2">
					  	<div style="background:#eee;width:100%;top:0;left:0;height:100%;"></div>
				  	</div>
				  </div>
			  </div>
			  <div class="question Q2 item col-sm-10">
			  	<div class="row">
					  <div class="col-xs-10">
			  		  <h6 class="question-number q-number">Question 2</h6>
						  <h5 class="question-text">Is that child a citizen or legal permanent resident?</h5>
						  <div class="answer-wrap">
							<div class="answer-tag">Answer A</div>
						  	<span class="answer">Yes</span> <span class="transit_text">goes to</span> <span class="destination_tag">Q3</span>
						  </div>
						  <div class="answer-wrap">
							<div class="answer-tag">Answer B</div>
						  	<span class="answer">No </span> <span class="transit_text">goes to</span> <span class="destination_tag">C1</span>
						  </div>
					  </div>
					  <div class="col-xs-2">
					  	<div style="background:#eee;width:100%;display:inline-table;">
					  		<i class="fa fa-ellipsis-v" aria-hidden="true" style="float:right;"></i>
					  	</div>
				  	</div>
			  	</div>
			  </div>
			  <div class="question Q3 item col-sm-10">
				  <div class="row">
						<div class="col-xs-10">
						  <h6 class="question-number q-number">Question 3</h6>
						  <h5 class="question-text">Was that child born before Nov. 21, 2014?</h5>
						  <div class="answer-wrap">
							<div class="answer-tag">Answer A</div>
						  	<span class="answer">Yes</span> <span class="transit_text">goes to</span> <span class="destination_tag">Q4</span>
						  </div>
						  <div class="answer-wrap">
							<div class="answer-tag">Answer B</div>
						  	<span class="answer">No </span> <span class="transit_text">goes to</span> <span class="destination_tag">C1</span>
						  </div>
					  </div>
					  <div class="col-xs-2">
					  	<div style="background:#eee;width:100%;display:inline-table;">
					  		<i class="fa fa-ellipsis-v" aria-hidden="true" style="float:right;"></i>
					  	</div>
				  	</div>
			  	</div>
			  </div>
			  <div class="question Q4 item col-sm-10">
			  	<h6 class="question-number q-number">Question 4</h6>
			  	<h5 class="question-text">Have you continuously lived in the U.S. since before Jan. 1, 2010?</h5>
			  		<div class="answer-wrap">
					<div class="answer-tag">Answer A</div>
				  	<span class="answer">Yes</span> <span class="transit_text">goes to</span> <span class="destination_tag">Q5</span>
				  </div>
				  <div class="answer-wrap">
					<div class="answer-tag">Answer B</div>
				  	<span class="answer">No </span> <span class="transit_text">goes to</span> <span class="destination_tag">C1</span>
				  </div>
			  </div>
			  <div class="question Q5 item col-sm-10">
			  	<h6 class="question-number q-number">Question 5</h6>
			  	<h5 class="question-text">Were you physically present in the U.S. on Nov. 20, 2014?</h5>
			  	<div class="answer-wrap">
					<div class="answer-tag">Answer A</div>
				  	<span class="answer">Yes</span> <span class="transit_text">goes to</span> <span class="destination_tag">Q6</span>
				  </div>
				  <div class="answer-wrap">
					<div class="answer-tag">Answer B</div>
				  	<span class="answer">No </span> <span class="transit_text">goes to</span> <span class="destination_tag">C1</span>
				  </div>
			  </div>
			  <div class="question Q6 item col-sm-10">
				  <h6 class="question-number q-number">Question 6</h6>
			  	<h5 class="question-text">Are you willing to pay taxes?</h5>
			  	<div class="answer-wrap">
					<div class="answer-tag">Answer A</div>
				  	<span class="answer">Yes</span> <span class="transit_text">goes to</span> <span class="destination_tag">Q7</span>
				  </div>
				  <div class="answer-wrap">
					<div class="answer-tag">Answer B</div>
				  	<span class="answer">No</span> <span class="transit_text">goes to</span> <span class="destination_tag">C1</span>
				  </div>
			  </div>
			  <div class="question Q7 item col-sm-10">
		  		<h6 class="question-number q-number">Question 7</h6>
				  <h5 class="question-text">Have you ever committed a significant crime or posted a threat to national security?</h5>
				  <div class="answer-wrap">
					<div class="answer-tag">Answer A</div>
				  	<span class="answer">Yes</span>
				  </div>
				  <div class="answer-wrap">
					<div class="answer-tag">Answer B</div>
				  	<span class="answer">No </span>
				  </div>
			  </div>
			  <div class="question Q8 item col-sm-10">
		  		<h6 class="question-number q-number">Question 8</h6>
				  <h5 class="question-text">Were you brought here as a child?</h5>
				  <div class="answer-wrap">
					<div class="answer-tag">Answer A</div>
				  	<span class="answer">Yes</span>
				  </div>
				  <div class="answer-wrap">
					<div class="answer-tag">Answer B</div>
				  	<span class="answer">No</span> <span class="transit_text">goes to</span> <span class="destination_tag">C1</span>
				  </div>
			  </div>
			  <div class="conclusion C1 item col-sm-12">
		  	<h6 class="question-number q-number">Conclusion 1</h6>
			  <h5 class="question-text">You are not elligible.</h5>
		  </div>
		  <div class="conclusion C2 item col-sm-12">
		  	<h6 class="question-number q-number">Conclusion 2</h6>
			  <h5 class="question-text">You are elligible!</h5>
		  </div>
		  </div>
		  <div class="col-sm-5" style="background:#D5D5D5;height:1px;margin:2em 0 1.5em 0;"></div>
	  

		</div>
	<script type="text/javascript">


		var question_two = $('.Q2');
		$(question_two).addClass('current_question');
		$(question_two).find('.answer-tag').addClass('active');
		var current_question = $('.question').hasClass('current_question');

		var q2_question_number = $('.Q2').find('.q-number').text();
		var q2_question_text = $('.Q2').find('.question-text').text();

		$('.question-field').attr('placeholder',q2_question_text);
		$('.fill').html(q2_question_number);
	

		$('.save').click(function() {
			alert('Saved!');
		})

		var stream_height = $('.stream').offset().top;
		var answer_tag_offset = $('.current_question').offset().top;
		var a_offset = $('.current_question .answer-wrap:nth-of-type(1)').offset().top;
		var b_offset = $('.current_question .answer-wrap:nth-of-type(2)').offset().top;			
		var a_adjusted = answer_tag_offset - a_offset - 17
		var b_adjusted = answer_tag_offset - b_offset - 17


		console.log('stream offset: '+stream_height+'. current question offset: '+answer_tag_offset+'.');

		$('.hl1').css({
			'top': (answer_tag_offset - stream_height) - a_adjusted
		})
		$('.hl2').css({
			'top': (answer_tag_offset - stream_height) - b_adjusted
		})
		$('.v1').css({
			'top': (answer_tag_offset - stream_height) - a_adjusted
		})
		$('.v2').css({
			'top': (answer_tag_offset - stream_height) - b_adjusted
		})


		$('.item').click(function(){
			var active_question = $(this);
			var active_question_number = $(this).find('.q-number').text();
			var active_question_text = $(this).find('.question-text').text();
			// var active_answer_a = $(this).find('.answer-wrap:nth-child(0)>.answer').text();
			
			$(this).addClass('current_question');
			$(this).find('.answer-tag').addClass('active');

			$('.item').not(this)
				.removeClass('current_question')
				.find('.answer-tag').removeClass('active');

			var a_destination_class = $('.current_question .answer-wrap:nth-of-type(1) .destination_tag').text();
			console.log('A dest class: ' + a_destination_class)
			var a_destination_top = $('.'+a_destination_class+'').offset().top;
			console.log('A dest top is ' + a_destination_top)

			var b_destination_class = $('.current_question .answer-wrap:nth-of-type(2) .destination_tag').text();
			console.log('B dest class: ' + b_destination_class)
			var b_destination_top = $('.'+ b_destination_class + '').offset().top;
			console.log('B dest top is ' + b_destination_top)


			$('.question-field').attr('placeholder',active_question_text);
			$('.fill').html(active_question_number);

			var stream_height = $('.stream').offset().top;
			var answer_tag_offset = $('.current_question').offset().top;
			var a_offset = $('.current_question .answer-wrap:nth-of-type(1)').offset().top;
			var b_offset = $('.current_question .answer-wrap:nth-of-type(2)').offset().top;			
			var a_adjusted = answer_tag_offset - a_offset - 17
			var b_adjusted = answer_tag_offset - b_offset - 17
			var hl1_top = (answer_tag_offset - stream_height) - a_adjusted
			var hl2_top = (answer_tag_offset - stream_height) - b_adjusted


			console.log('stream offset: '+stream_height+'. HL1 top: '+hl1_top+'.');

			$('.hl1').css({
				'top': hl1_top
			})
			$('.hl2').css({
				'top': hl2_top
			})
			$('.v1').css({
				'top': (answer_tag_offset - stream_height) - a_adjusted,
				'min-height': a_destination_top - hl1_top
			})
			$('.v2').css({
				'top': (answer_tag_offset - stream_height) - b_adjusted,
				'min-height': b_destination_top - hl2_top
			})
			
		})

		

	</script>
  	
</body>
